<div [ngClass]="dynamicBackground">

  <p class="title">BIENVENIDO A MI PROGRAMA EN ANGULAR.JS</p>
  <p class="subtitle">IMPORTACIÓN DE EXCELS Y SU CONSIGUIENTE VISUALIZACIÓN</p>

  <p class="date-time">Fecha y Hora Actual: {{ currentDate }}</p>

  <div class="action-buttons">
    <button class="boton" (click)="exportToExcel()">Guardar Cambios</button>
    <button class="boton">
      <i class="fa fa-check-circle"></i> 2. Revisión de controles
    </button>
    <button class="boton">
      <i class="fa fa-map-marker"></i> 3. Localizar municipio/provincia
    </button>
    <button class="boton">
      <i class="fa fa-search"></i> 4. Localizar registros
    </button>
    <button class="boton">
      <i class="fa fa-history"></i> 5. Búsqueda de antecedentes
    </button>
    <button class="boton">
      <i class="fa fa-building"></i> 6. Búsqueda tipos de bien
    </button>
    <button class="boton primary">
      <i class="fa fa-file-text"></i> 7. Generar Encargo
    </button>
    <button class="boton">
      <i class="fa fa-copy"></i> 8. Copiar antecedentes
    </button>
  </div>

  <input class="input_xlsx" type="file" (change)="onFileChange($event)" accept=".xls,.xlsx"/>

  <p class="message" *ngIf="excelData.length === 0">No hay datos disponibles</p>

  <div *ngIf="sheetNames.length > 0" class="style">
    <ul class="horizontal">
      <li *ngFor="let sheetName of sheetNames; let i = index">
        <button (click)="loadSheet(i)">
          {{ sheetName }}
        </button>
      </li>
    </ul>
  </div>

  <input class="input1" type="text" [(ngModel)]="selectedCellValue" (ngModelChange)="UpdateCell()" placeholder="Selecciona una celda" />

  <div class="styles">
    <div class="table-container">
      <table *ngIf="excelData.length > 0">
        <tr *ngFor="let row of excelData; let rowIndex = index">
          <td *ngFor="let cell of row; let colIndex = index" (click)="selectCell(rowIndex, colIndex)">
           {{cell}}
          </td>
        </tr>
      </table>
    </div>
  </div>
  
</div>